{"version":3,"file":"BlobSVG.js","names":[],"sources":["../../src/svelte/BlobSVG.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { browser } from '../core/browser.js';\n\timport type { BlobPhysics } from '../core/BlobPhysics.js';\n\timport type { ConvexBlob } from '../core/types.js';\n\n\t// Props using Svelte 5 $props() syntax\n\tinterface Props {\n\t\tblobs?: ConvexBlob[];\n\t\tcontainerElement?: HTMLElement | undefined;\n\t\tphysics?: BlobPhysics | null;\n\t}\n\n\tlet { blobs = [], containerElement = undefined, physics = null }: Props = $props();\n\n\t// Track dark mode for blend mode switching\n\tlet isDarkMode = $state(false);\n\tlet primaryBlend = $derived(isDarkMode ? 'screen' : 'multiply');\n\n\t// Watch for dark mode changes\n\t$effect(() => {\n\t\tif (browser) {\n\t\t\tisDarkMode = document.documentElement.classList.contains('dark');\n\n\t\t\tconst observer = new MutationObserver((mutations) => {\n\t\t\t\tfor (const mutation of mutations) {\n\t\t\t\t\tif (mutation.attributeName === 'class') {\n\t\t\t\t\t\tisDarkMode = document.documentElement.classList.contains('dark');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tobserver.observe(document.documentElement, { attributes: true });\n\n\t\t\treturn () => observer.disconnect();\n\t\t}\n\t});\n\n\t// Generate simple circle path (fast) - used for glow/core layers\n\tfunction getCirclePath(cx: number, cy: number, r: number): string {\n\t\treturn `M ${cx - r},${cy} A ${r},${r} 0 1,1 ${cx + r},${cy} A ${r},${r} 0 1,1 ${cx - r},${cy}`;\n\t}\n\n\t// Generate organic path for main blob body only\n\tfunction getBlobPath(blob: ConvexBlob): string {\n\t\tif (physics && blob.controlPoints && blob.controlPoints.length > 0) {\n\t\t\treturn physics.generateSmoothBlobPath(blob);\n\t\t}\n\t\treturn getCirclePath(blob.currentX, blob.currentY, blob.size);\n\t}\n</script>\n\n<!-- Extended viewBox for margin overflow -->\n<svg\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"-33 -33 133 133\"\n\tpreserveAspectRatio=\"xMidYMid slice\"\n\tclass=\"h-full w-full\"\n>\n\t<defs>\n\t\t<!-- Simple glow filter -->\n\t\t<filter id=\"glowFilter\" x=\"-100%\" y=\"-100%\" width=\"300%\" height=\"300%\">\n\t\t\t<feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"4.0\" result=\"glow\" />\n\t\t</filter>\n\n\t\t<!-- Soft edge filter -->\n\t\t<filter id=\"softEdge\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n\t\t\t<feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"1.5\" result=\"soft\" />\n\t\t</filter>\n\n\t\t<!-- Gradients for each blob -->\n\t\t{#each blobs as blob, i (blob.gradientId)}\n\t\t\t<!-- Glow gradient (outer) -->\n\t\t\t<radialGradient id=\"{blob.gradientId}Glow\" cx=\"50%\" cy=\"50%\" r=\"80%\">\n\t\t\t\t<stop offset=\"0%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.5} />\n\t\t\t\t<stop offset=\"40%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.3} />\n\t\t\t\t<stop offset=\"70%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.15} />\n\t\t\t\t<stop offset=\"100%\" stop-color={blob.color} stop-opacity=\"0\" />\n\t\t\t</radialGradient>\n\n\t\t\t<!-- Main gradient -->\n\t\t\t<radialGradient id=\"{blob.gradientId}Main\" cx=\"50%\" cy=\"50%\" r=\"50%\">\n\t\t\t\t<stop offset=\"0%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.9} />\n\t\t\t\t<stop offset=\"50%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.6} />\n\t\t\t\t<stop offset=\"80%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.3} />\n\t\t\t\t<stop offset=\"100%\" stop-color={blob.color} stop-opacity=\"0\" />\n\t\t\t</radialGradient>\n\n\t\t\t<!-- Core gradient (inner highlight) -->\n\t\t\t<radialGradient id=\"{blob.gradientId}Core\" cx=\"50%\" cy=\"50%\" r=\"30%\">\n\t\t\t\t<stop offset=\"0%\" stop-color={blob.color} stop-opacity={blob.intensity * 1.0} />\n\t\t\t\t<stop offset=\"60%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.7} />\n\t\t\t\t<stop offset=\"100%\" stop-color={blob.color} stop-opacity={blob.intensity * 0.3} />\n\t\t\t</radialGradient>\n\t\t{/each}\n\t</defs>\n\n\t<!-- Layer 1: Glow halo (simple circles, blurred) -->\n\t<g filter=\"url(#glowFilter)\" opacity=\"0.35\">\n\t\t{#each blobs as blob (blob.gradientId)}\n\t\t\t<path\n\t\t\t\td={getCirclePath(blob.currentX, blob.currentY, blob.size * 2.5)}\n\t\t\t\tfill=\"url(#{blob.gradientId}Glow)\"\n\t\t\t/>\n\t\t{/each}\n\t</g>\n\n\t<!-- Layer 2: Main blob body with organic paths -->\n\t<g filter=\"url(#softEdge)\" style:mix-blend-mode={primaryBlend} opacity=\"0.75\">\n\t\t{#each blobs as blob (blob.gradientId)}\n\t\t\t<path\n\t\t\t\td={getBlobPath(blob)}\n\t\t\t\tfill=\"url(#{blob.gradientId}Main)\"\n\t\t\t/>\n\t\t{/each}\n\t</g>\n\n\t<!-- Layer 3: Core highlight (simple circles) -->\n\t<g style:mix-blend-mode={primaryBlend} opacity=\"0.9\">\n\t\t{#each blobs as blob (blob.gradientId)}\n\t\t\t<path\n\t\t\t\td={getCirclePath(blob.currentX, blob.currentY, blob.size * 0.6)}\n\t\t\t\tfill=\"url(#{blob.gradientId}Core)\"\n\t\t\t/>\n\t\t{/each}\n\t</g>\n</svg>\n"],"mappings":"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"}